<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>login form</title>
    <link rel="stylesheet" href="loginstyle.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
</head>
<body>
    
    <div class="wrapper">
        <form id="loginForm">
            <h1>LOGIN</h1>
            <div class="input-box">
                <input type="email" id = "email" name = "email" placeholder="Email" required>
                <i class='bx bx-user'></i>
            </div>
            <div class="input-box">
                <input type="password" id = "password" name = "password" placeholder="Password" required>
                <i class='bx bxs-lock-alt' ></i>            </div>
            <div class="remember-forget">
                <label><input type="checkbox">Remember Me</label>
                <a href="#">Forget Password?</a><br><br>
            </div>
            <div class="home">
             <a href="index.html" class = "home">Home</a><br><br>
            </div>
           
            <center><button type = "submit" class = "btn">Login</button></center>


        </form>
    </div>
    <script>
        document.getElementById("loginForm").addEventListener("submit", async(event)=>{
            event.preventDefault();

            const formData = new FormData(event.target);
            const email = formData.get("email");
            const password = formData.get("password");

            try{
                const response = await fetch("/login", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({email, password})
                });
                  
                if(!response.ok){
                    throw new Error("Invalid email or password");
                }


                const data = await response.json();
                if(data.token){

                    window.location.href = "indexhall.html";
                }
                else{
                    throw new Error("Token not found in response");
                }
            }catch(error){
                console.error("Error during  login:", error);
                alert("Error during login: "+error.message);

            }
        });
    </script>
   
    
</body>
</html>